<script src="/socket.io/socket.io.js"></script>
<script src="/peer.js"></script>
<script>
window["socket"] = io(location.hostname+":"+location.port);
socket.on("connect",           console.info.bind(console, "connect"));
socket.on("reconnect",         console.info.bind(console, "reconnect"));
socket.on("reconnect_attempt", console.info.bind(console, "reconnect_attempt"));
socket.on("reconnecting",      console.info.bind(console, "reconnecting"));
socket.on("reconnect_error",   console.info.bind(console, "reconnect_error"));
socket.on("reconnect_failed",  console.info.bind(console, "reconnect_failed"));
socket.on("disconnect",        console.info.bind(console, "disconnect"));
socket.on("error",             console.info.bind(console, "error"));
socket.on("echo",              console.info.bind(console, "echo"));
socket.on("connect",           function(){ socket.emit("echo", socket.id); });

window["peer"] = new Peer({host: location.hostname, port: location.port, path: "peerjs", secure: true, debug: 3});
peer.on('open',         console.info.bind(console, "open"));
peer.on('connection',   console.info.bind(console, "connection"));
peer.on('call',         console.info.bind(console, "call"));
peer.on('close',        console.info.bind(console, "close"));
peer.on('disconnected', console.info.bind(console, "disconnected"));
peer.on('error',        console.info.bind(console, "error"));

console.log("init");


window.navigator["getUserMedia"] = window.navigator.webkitGetUserMedia ||
                                   window.navigator.mozGetUserMedia    ||
                                                                      window.navigator.getUserMedia;


navigator.getUserMedia({video: false, audio: true}, right, left);
function left(){ throw err; }
function right(stream){
  console.log(stream);
}
</script>
